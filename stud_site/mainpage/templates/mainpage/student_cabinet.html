{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Личный кабинет ученика</title>
    <link rel="stylesheet" href="{% static 'mainpage/css/style_cabinet.css' %}">
</head>
<body>

    <header class="page-header">
        <div class="container">
            <nav>
                <a href="{% url 'home' %}" class="nav-link">Главная</a>
            </nav>
        </div>
    </header>

    <h1>Добро пожаловать в личный кабинет</h1>
    <p>Здесь отображается информация и настройки ученика.</p>

    {% if messages %}
        <ul style="color:green;">
            {% for message in messages %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <h2>Редактировать профиль</h2>
    <form method="post" enctype="multipart/form-data" action="{% url 'update_profile' %}">
        {% csrf_token %}

        <label for="name">Имя:</label>
        <input type="text" id="name" name="name" value="{{ profile.name }}" required><br><br>

        <label for="lastname">Фамилия:</label>
        <input type="text" id="lastname" name="lastname" value="{{ profile.lastname }}" required><br><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" value="{{ user.email }}" required><br><br>

        <label for="photo">Фото:</label>
        <input type="file" id="photo" name="photo" accept="image/*"><br><br>

        {% if profile.photo %}
            <img src="{{ profile.photo.url }}" alt="Ваше фото" id="photo-preview" />
        {% else %}
            <img src="{% static 'mainpage/img/default_user_photo.png' %}" alt="Фото отсутствует" id="photo-preview" />
        {% endif %}

        <button type="submit">Сохранить изменения</button>
    </form>

    <h2>Система тестирования</h2>
    <ul>
        <li><a href="{% url 'mainpage' %}">Система тестирования</a></li>
        <li><a href="{% url 'student_test_list' %}" class="nav-link {% if request.resolver_match.url_name == 'test_list' %}active{% endif %}">К тестам</a></li>
    </ul>

    <h2>Домашние задания</h2>
    <ul>
        <li><a href="{% url 'homework_upload' %}">Загрузить домашнее задание</a></li>
        <li><a href="{% url 'homework_download' %}">Скачать домашнее задание</a></li>
    </ul>

    <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit">Выйти</button>
    </form>

    <script>
    document.getElementById('photo').addEventListener('change', function(event) {
        const [file] = this.files;
        if (file) {
            const preview = document.getElementById('photo-preview');
            preview.src = URL.createObjectURL(file);
        }
    });
    </script>
</body>
</html>